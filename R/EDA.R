library(readr)
mammalsleep <- read_csv("C:/Users/Rita/DataScience/data/mammalsleep.csv")
View(mammalsleep)
 summary (mammalsleep)
#bw ???????? ???? ?????????? ???????????? ???????? ???????? ??????????????
 
 mammalsleep$species <- factor(mammalsleep$species)
 #factor ???????? ??????????????????
 summary(mammalsleep$species)
 
 mammalsleep$pi <- factor(mammalsleep$pi)
 mammalsleep$sei <- factor(mammalsleep$sei)
 mammalsleep$odi <- factor(mammalsleep$odi)
 summary (mammalsleep)

 cor(mammalsleep$bw, mammalsleep$brw, method="spearman") 
#???? ???????? ???????? ?????????? ???????????? ???????? ???????????????? 
#?????????????? ???? ???????????? ???????? ???????? ?????????? ???? ?????????????? ??????????????
#???????????? ???????? ???????? ?????????????? 75%
#?????? ?????????????? ???? -????????????, ????????????
cor.test(mammalsleep$bw, mammalsleep$brw, method="spearman")
#?????? ???????? ???????? ???? p-value
cor.test(mammalsleep$bw, mammalsleep$sws, method="spearman",na.rm=T)
#?????????? ?????????? ?????? ?????? ?????????? ??????????
#?????? ?????????? ???????? ???????? ????????, ???? ?????????? ?????? ?????????? ?????? ???????? ??????????
cor.test(mammalsleep$bw, mammalsleep$ts, method="spearman",na.rm=T)
#???????? ???? ???????? ???????? ???????? ?????????? ????????
cor.test(mammalsleep$bw, mammalsleep$mls, method="spearman",na.rm=T)
#?????? ???????? ???????? ??????????, ?????? ????????
cor.test(mammalsleep$brw, mammalsleep$mls, method="spearman",na.rm=T)
# ???????? ????????
cor.test(mammalsleep$bw, mammalsleep$gt, method="spearman",na.rm=T)
#?????? ?????????? ???????? ?????????? , ???? ???????????? ?????? ???????? ????????
cor.test(mammalsleep$mls, mammalsleep$gt, method="spearman",na.rm=T)
#?????? ???????? ?????? ?????? ???????? ?????? ???????? ?????? ????????????
cor.test(mammalsleep$mls, mammalsleep$odi, method="spearman",na.rm=T)
#???? ???????? ?????????? ???????????? ?????? ???????? ???????? ????????????????
#???? ???????? ???????? ????????????
cor.test(mammalsleep$mls, as.numeric(mammalsleep$odi), method="spearman",na.rm=T)
#?????????? ???? ??????????????, ?????? ?????? ?????? ?????? ?????? ?????? ???????? ???????? ??????????
#???? ???? ???????????? ?????????? ???? ???????? ?????????? ?????????? ???????????? ?????????? ??????????, ???? ?????????????????? ????????????
#?????????? ???????? ?????????????? ?????????????? ???? ???? ???????????? ?????????????? ?????? ????????????????
library(Hmisc)
rcorr(as.matrix(mammalsleep[,3:9]), type="spearman")
#?????????? ?????????????? ?????????????? ???? ???????????? ??????????????
#???????? ???????? ???? ?????? ???????????? ?????????? ????????????????, ?????? ?????????? ?????????? ?????????? ???????? ?????????? ?????? ?????????? ?????????? ?????????? ???? ????????
#???????? ???????????? ???? ??p-value, ???????? ?????????????? ???????? ???? ?????????????? ???? ???? ????????
t.test(mammalsleep$ts, mammalsleep$ps, paired = TRUE)
#?????????? ?????????????? ???????????? ?????????? ???? ?????? ??p-value ??????????
#?????????? ???? ???????? ?????? ?????? ????????????
mammalsleep$higrisk <- ifelse (mammalsleep$odi==4 | mammalsleep$odi==5,1,0)
#odi ???????? ??-4 ???? ??-5
table (mammalsleep$higrisk)

library(dplyr)
#???????? ???? ???????????? ???? low ?????? ???????? ?????????? ???? ???? ???????? ???????? 0 ?????? ???????? ???? ?????? mls
low<-mammalsleep%>%filter(higrisk==0)%>%select(mls)
hi<-mammalsleep%>%filter(higrisk==1)%>%select(mls)

t.test(low$mls, hi$mls, paired = FALSE)
#???? paired ???? ?????? ???????????? ??????????
#?????? p-value ???? ??????????
#?????????? ???? ???????????? ???? ???? ??????????  ?????? ???????????? ???? ?????????? non-paired

#???????? ????, ???? ???????? ????????????????
chisq.test(mammalsleep$odi,mammalsleep$sei)
#?????? ?????????????? ???????? ???????? ?????????? ????????, ???? ???????????? ?????????? ?????? ???????? ????????, ???? ???????? ???? ???? ???????? ??????
table(odi=mammalsleep$odi, sei=mammalsleep$sei)
#?????????? ???? ????????????,



#######???????? ??????????
pie(table(mammalsleep$higrisk), labels=c("High","Low"), main ="Pie CHART OF Highrisk", radius =1.5 )
barplot(table(mammalsleep$higrisk))

library(ggplot2)

ggplot(data=mammalsleep)+
 geom_bar(aes(x=odi,group=factor(higrisk), color=higrisk ))

